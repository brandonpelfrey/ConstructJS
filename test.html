<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>
<body>

<div id="container"></div>

<script src="js/stats.min.js"></script>
<script src="js/three.min.js"></script>

<script src="js/construct/construct-base.js"></script>
<script src="js/construct/construct-webgl.js"></script>
<script src="js/construct/construct-user-functions.js"></script>

<script>
    (function(obj){ for(var key in obj) window[key] = obj[key]; })(Construct.UserFunctions);
</script>

<script>
    // Simple FPS gauage
    var stats = new Stats();
    stats.domElement.style.position = 'absolute';
    stats.domElement.style.left = '0px';
    stats.domElement.style.top = '0px';
    document.body.appendChild( stats.domElement );

    // Create a WebGL context for displaying to the user (and creating render targets)
    var renderer = new THREE.WebGLRenderer();
        renderer.setSize( 512, 512 );

    document.getElementById( 'container' ).appendChild( renderer.domElement );

    // A few functions for playing around and testing
    // Translation: g(x) = field( x - displacement(x) )
    function translate( field, displacement ) { return warp( field, sub(identity(), displacement) ); }

    // The signed distance to the center of a circle
    // f(x) = radius - length( x - center )
    function circle( center, radius ) { return sub(radius, length( sub(center, identity() ) ) ); }

    // Mask a unit circle (1 inside the circle, 0 outside)
    var q = mask( circle( vf(0,0), sf(1) ) ) ;
    
    animate();

    function animate() {
      stats.begin();
         
      qg = writeToGrid(q, renderer);
      q = qg;
      //q = mul(sf(1.1), qg);
        //q = qg;
      Construct.WebGL.render(qg, {renderer: renderer});

      stats.end();
      requestAnimationFrame( animate );
    }

</script>

</body>
</html>
